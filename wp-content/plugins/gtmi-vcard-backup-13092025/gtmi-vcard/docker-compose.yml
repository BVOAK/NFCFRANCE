services:
  wordpress:
    image: wordpress:latest
    restart: always
    ports:
      - "8000:80" # Mappe le port 8000 de votre machine vers le port 80 du conteneur WordPress
    environment:
      WORDPRESS_DB_HOST: db:3306 # Le nom du service de la base de données et son port
      WORDPRESS_DB_NAME: WORDPRESS_DB_NAME # Nom de la base de données
      WORDPRESS_DB_USER: WORDPRESS_DB_USER # Nom d'utilisateur de la base de données
      WORDPRESS_DB_PASSWORD: WORDPRESS_DB_PASSWORD # Mot de passe de la base de données (À CHANGER POUR LA PRODUCTION !)
      WORDPRESS_URL: http://localhost:8000
      WORDPRESS_DEBUG: 1
      WORDPRESS_CONFIG_EXTRA: |
        define( 'WP_DEBUG_DISPLAY', true );
        define( 'WP_DEBUG_LOG', true );
    volumes:
      # - ./wp-content:/var/www/html/wp-content # Mappe le dossier wp-content local pour persistance des thèmes/plugins
      - ./wp-content:/var/www/html/wp-content
    depends_on:
      - db

  db:
    image: mysql:8.0 # Utilise l'image MySQL 8.0
    restart: always
    environment:
      MYSQL_ROOT_PASSWORD: root_password # Mot de passe root pour MySQL (À CHANGER POUR LA PRODUCTION !)
      MYSQL_DATABASE: WORDPRESS_DB_NAME # Doit correspondre à WORDPRESS_DB_NAME
      MYSQL_USER: WORDPRESS_DB_USER # Doit correspondre à WORDPRESS_DB_USER
      MYSQL_PASSWORD: WORDPRESS_DB_PASSWORD # Doit correspondre à WORDPRESS_DB_PASSWORD
    volumes:
      - db_data:/var/lib/mysql # Volume persistant pour les données de la base de données
  
  phpmyadmin: # Nouveau service pour phpMyAdmin
    image: phpmyadmin/phpmyadmin:latest # Utilise la dernière image officielle de phpMyAdmin
    ports:
      - "8888:80" # Mappe le port 8080 de votre machine vers le port 80 du conteneur phpMyAdmin
    environment:
      PMA_HOST: db # phpMyAdmin se connectera au service 'db' (votre conteneur MySQL)
      # MYSQL_ROOT_PASSWORD: "" # Utilisez le même mot de passe root que pour votre service 'db'
      PMA_USER: root # Optionnel, si vous voulez vous connecter directement en tant que root
      PMA_PASSWORD: root_password # Optionnel, mot de passe pour PMA_USER
    depends_on:
      - db # S'assure que la base de données est lancée avant phpMyAdmin
volumes:
  db_data: {} # Définit le volume nommé pour la persistance des données MySQL